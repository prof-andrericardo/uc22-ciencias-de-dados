# 📘 UC22 – Aula 4 — Seleção de Colunas (Pandas)

*(Versão Alunos – passo a passo, com explicações e códigos comentados)*

![Python](https://img.shields.io/badge/Python-3.11+-blue?logo=python)
![Pandas](https://img.shields.io/badge/Pandas-Sele%C3%A7%C3%A3o%20de%20Colunas-green?logo=pandas)
![Google Colab](https://img.shields.io/badge/Google%20Colab-Notebook-yellow?logo=googlecolab)
![Tempo](https://img.shields.io/badge/Dura%C3%A7%C3%A3o-90%20min-red)
![Nível](https://img.shields.io/badge/N%C3%ADvel-Iniciante%E2%9E%9CIntermedi%C3%A1rio-purple)

🎓 **Turma:** 3º Ano – Ensino Médio Técnico em Informática  
📍 **Tema:** Seleção (escolha) de colunas em DataFrames do Pandas  
🐍 **Ferramenta principal:** Google Colab  

---

## ✨ Frase motivadora

> “Selecionar colunas é como escolher as peças certas para montar um LEGO de insights.” – IAra 🧩

---

## 🎯 Objetivos de aprendizagem

Ao final desta aula, você será capaz de:

- Selecionar **uma** ou **várias** colunas por **nome**.  
- Selecionar colunas por **padrão** de nomes (`filter`, `startswith`, `endswith`, `regex`).  
- Selecionar colunas por **tipo de dado** (`select_dtypes`).  
- Selecionar colunas por **posição** (`.iloc`).  
- **Garantir** que colunas existem e lidar com **ausências** com segurança.  
- **Renomear**, **reordenar** e **remover** colunas de forma segura.  

---

## 🧠 Lembretes rápidos (Aula 3)

- **DataFrame**: tabela (linhas × colunas) dentro do Python.  
- **Series**: uma única coluna do DataFrame.  
- `df['col']` retorna **Series**; `df[['col']]` retorna **DataFrame**.  
- **Padronizar** nomes (minúsculas, sem espaços) facilita tudo.  

---

## 📂 Preparação dos dados (Google Drive)

> Use os mesmos arquivos das aulas anteriores, já salvos no **Google Drive → pasta UC22**:  
>
> - `pokemons_pokedex.csv`  
> - `escolas_estaduais_censo_escolar_2023.csv`  

```python
# 📂 Conectando o Google Drive
from google.colab import drive
drive.mount('/content/drive')

import pandas as pd

# --- Caminhos dos arquivos (ajuste conforme sua pasta) ---
caminho_poke = "/content/drive/MyDrive/UC22/pokemons_pokedex.csv"
caminho_escolas = "/content/drive/MyDrive/UC22/escolas_estaduais_censo_escolar_2023.csv"

# --- Leitura dos datasets ---
df_poke = pd.read_csv(caminho_poke, encoding="utf-8")
df_escolas = pd.read_csv(caminho_escolas, encoding="latin-1", sep=",")

# --- Padronização de nomes de colunas ---
df_poke.columns    = df_poke.columns.str.strip().str.lower().str.replace(" ", "_", regex=False)
df_escolas.columns = df_escolas.columns.str.strip().str.lower().str.replace(" ", "_", regex=False)

# --- Ajuste de municípios para melhor leitura ---
if "no_municipio" in df_escolas.columns:
    df_escolas["no_municipio"] = df_escolas["no_municipio"].astype(str).str.strip().str.title()

print("✅ Pokémon:", df_poke.shape, "colunas:", len(df_poke.columns))
print("✅ Escolas:", df_escolas.shape, "colunas:", len(df_escolas.columns))
```

------

## 1) Seleção de colunas por **nome**

### 1.1 Uma coluna (retorna **Series**)

```python
print("Colunas Pokémon:", list(df_poke.columns)[:10])
uma_coluna_poke = df_poke.columns[0]
serie_poke = df_poke[uma_coluna_poke]

print("Coluna escolhida:", uma_coluna_poke)
print("Tipo retornado:", type(serie_poke))
display(serie_poke.head())
```

### 1.2 Múltiplas colunas (retorna **DataFrame**)

```python
cols_poke = list(df_poke.columns[:3])
sub_poke  = df_poke[cols_poke]

print("Colunas selecionadas:", cols_poke)
display(sub_poke.head())
```

------

## 2) Seleção por **padrão** no nome da coluna

### 2.1 `filter(like=...)` – contém

```python
poke_hp_cols  = df_poke.filter(like="hp").columns.tolist()
poke_atk_cols = df_poke.filter(like="atk").columns.tolist()
print("HP:", poke_hp_cols, " | ATK:", poke_atk_cols)

sub_like = df_poke[poke_hp_cols + poke_atk_cols]
display(sub_like.head())
```

### 2.2 `filter(regex=...)` – expressão regular

```python
regex_cols = df_escolas.filter(regex=r"^(no_|co_)").columns.tolist()
print("Regex:", regex_cols)
display(df_escolas[regex_cols].head())
```

### 2.3 `startswith` / `endswith`

```python
cols_tipo = [c for c in df_poke.columns if c.startswith("tipo")]
print("Colunas que começam com 'tipo':", cols_tipo)
display(df_poke[cols_tipo].head())
```

------

## 3) Seleção por **tipo de dado** (dtypes)

```python
num_poke = df_poke.select_dtypes(include=["int64", "float64"])
obj_poke = df_poke.select_dtypes(include=["object"])

print("Numéricas Pokémon:", num_poke.columns.tolist()[:5])
print("Texto Pokémon:", obj_poke.columns.tolist()[:5])
```

------

## 4) Seleção por **posição** (colunas pelo índice)

```python
sub_pos_poke = df_poke.iloc[:, [0, 1, 2]]  # 3 primeiras colunas
display(sub_pos_poke.head())
```

------

## 5) Garantindo colunas (checagens e mensagens amigáveis)

```python
def selecionar_colunas_seguras(df, colunas_desejadas):
    existentes = [c for c in colunas_desejadas if c in df.columns]
    faltantes  = [c for c in colunas_desejadas if c not in df.columns]
    if faltantes:
        print("⚠️ Colunas inexistentes ignoradas:", faltantes)
    return df[existentes]

cols_escolas = ["no_entidade", "no_municipio", "tp_dependencia"]
sub_escolas = selecionar_colunas_seguras(df_escolas, cols_escolas)
display(sub_escolas.head())
```

------

## 6) Renomear, reordenar e remover colunas

### 6.1 Renomear

```python
df_escolas_ren = df_escolas.rename(columns={
    "no_entidade": "nome_escola",
    "no_municipio": "municipio",
    "tp_dependencia": "dependencia"
})
```

### 6.2 Reordenar

```python
preferencia = ["municipio", "nome_escola", "dependencia"]
nova_ordem = [c for c in preferencia if c in df_escolas_ren.columns] + \
             [c for c in df_escolas_ren.columns if c not in preferencia]
df_escolas_ord = df_escolas_ren[nova_ordem]
```

### 6.3 Remover

```python
df_escolas_drop = df_escolas_ord.drop(columns=["coluna_inexistente"], errors="ignore")
```

------

## ✅ Checklist do que você aprendeu hoje

- Selecionar **1** ou **N** colunas por **nome**.
- Selecionar colunas por **padrão** (`like`, `regex`, `startswith`).
- Selecionar por **tipo** (`select_dtypes`).
- Selecionar por **posição** (`.iloc`).
- Garantir colunas com segurança.
- Renomear, reordenar e remover colunas.

------

## 🧪 Mini-Lab (para entregar no Classroom)

**Arquivo:** `UC22_Aula04_Pratica_SeuNome.ipynb`

1. **Pokémon**
   - Liste todas as colunas.
   - Selecione `nome` + 3 atributos de combate (HP/ATK/DEF).
   - Mostre apenas essas colunas (10 primeiras linhas).
2. **Escolas**
   - Liste todas as colunas.
   - Selecione código(s), nome da escola e município.
   - Renomeie para `codigo`, `nome_escola`, `municipio`.
   - Reordene para que `municipio` venha primeiro.
3. **Extras**
   - Crie um DataFrame só com **colunas numéricas**.
   - Outro só com **colunas de texto**.
   - Selecione **3 colunas por posição** usando `.iloc`.

------

## 🧯 Erros comuns

- **KeyError** → coluna não existe (`df.columns` ajuda a confirmar).
- **Tudo em uma coluna só** → erro de separador (`sep=";"`).
- **Acentos quebrados** → erro de encoding (`latin-1`).
- **Warning ao editar subconjuntos** → use `.copy()` antes de modificar.

------

## 📎 Conclusão

Hoje você dominou várias formas de **selecionar colunas**, base para:

- **Aula 5:** filtros de linhas (responder perguntas como *“quais escolas em tal município?”* ou *“quais Pokémons têm HP > X?”*).
- **Aula 6:** juntar seleção de colunas + filtros de linhas para análises completas.

------

💡 **Extra (opcional – avançado):**
 Se quiser experimentar, você pode criar uma função de leitura resiliente que testa diferentes encodings e separadores (`utf-8`, `latin-1`, `,`, `;`). Isso ajuda em datasets problemáticos, mas **não é obrigatório nesta fase**.

